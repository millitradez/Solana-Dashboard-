<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Solana Dashboard</title>
  <style>
    body { font-family: Arial, sans-serif; background: linear-gradient(180deg, #002a5c, #004080); color: white; text-align: center; padding: 30px; }
    button { background-color: #00c46b; color: white; border: none; border-radius: 5px; padding: 10px 20px; margin: 10px; cursor: pointer; font-size: 16px; }
    input { width: 80%; padding: 10px; margin: 10px; border-radius: 5px; border: none; font-size: 16px; }
    .log-box { background: rgba(0,0,0,0.4); border-radius: 8px; padding: 15px; margin-top: 20px; text-align: left; font-family: monospace; }
  </style>
</head>
<body>
  <h2>üåê Solana Dashboard</h2>
  <button id="connectButton">üîå Connect Wallet</button>
  <div id="status">Not connected ‚ùå</div>

  <h3>Check Token Price</h3>
  <input id="tokenInput" placeholder="Enter Solana token address" />
  <br />
  <button onclick="getPrice()">üí∞ Get Price</button>
  <div>
    <button onclick="fillToken('So11111111111111111111111111111111111111112')">SOL</button>
    <button onclick="fillToken('EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v')">USDC</button>
    <button onclick="fillToken('DezXAZ8z7PnrnRJjz3wXBoRgixCa6xjr9mXAdrsXgPa')">BONK</button>
  </div>
  <div id="priceOutput"></div>

  <div class="log-box" id="log"></div>

  <script>
    const logBox = document.getElementById('log');
    const statusDiv = document.getElementById('status');

    function log(msg) {
      const time = new Date().toLocaleTimeString();
      logBox.innerHTML += `[${time}] ${msg}<br>`;
      logBox.scrollTop = logBox.scrollHeight;
    }

    let wallet = null;

    async function connectWallet() {
      try {
        log('Requesting wallet connection...');
        statusDiv.innerText = 'üîÑ Connecting...';
        if (window.coin98 && window.coin98.sol) {
          wallet = window.coin98.sol;
          const res = await wallet.connect();
          if (res.publicKey) {
            log(`Connected: ${res.publicKey}`);
            statusDiv.innerText = `‚úÖ Connected: ${res.publicKey.slice(0,6)}...`;
          } else {
            throw new Error('No public key returned');
          }
        } else {
          throw new Error('Coin98 wallet not detected');
        }
      } catch (e) {
        log(`‚ùå Connection failed: ${e.message}`);
        statusDiv.innerText = '‚ùå Connection rejected';
      }
    }

    async function getPrice() {
      const address = document.getElementById('tokenInput').value.trim();
      if (!address) {
        log('Please enter a token address.');
        return;
      }
      log(`Fetching price for token: ${address}`);

      const url = `https://api.coingecko.com/api/v3/simple/token_price/solana?contract_addresses=${address}&vs_currencies=usd`;
      try {
        const res = await fetch(url);
        const data = await res.json();
        const price = data[address.toLowerCase()]?.usd;
        if (price) {
          document.getElementById('priceOutput').innerText = `üíµ Price: $${price}`;
          log(`‚úÖ Token price: $${price}`);
        } else {
          document.getElementById('priceOutput').innerText = '‚ùå Token not found';
          log('Token not found on CoinGecko.');
        }
      } catch (err) {
        log(`Error fetching price: ${err.message}`);
      }
    }

    function fillToken(address) {
      document.getElementById('tokenInput').value = address;
      log(`Auto-filled token: ${address}`);
    }

    document.getElementById('connectButton').onclick = connectWallet;
    log('Page loaded. Ready for wallet connection.');
  </script>
</body>
</html>
